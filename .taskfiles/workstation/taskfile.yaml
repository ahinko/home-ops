# yaml-language-server: $schema=https://taskfile.dev/schema.json
---
version: 3

env:
  WORKSTATION_RESOURCES_DIR: "{{.ROOT_DIR}}/.taskfiles/workstation/resources"

tasks:
  brew:
    desc: Set up Homebrew tools
    cmd: brew bundle --file {{.WORKSTATION_RESOURCES_DIR}}/Brewfile
    generates:
      - "{{.WORKSTATION_RESOURCES_DIR}}/Brewfile.lock.json"
    preconditions:
      - command -v brew
      - test -f {{.WORKSTATION_RESOURCES_DIR}}/Brewfile

  krew:
    desc: Install/update all required dependencies
    silent: true
    cmds:
      - kubectl krew install cnpg rook-ceph browse-pvc view-secret node-shell
    preconditions:
      - kubectl krew version
      - which kubectl
