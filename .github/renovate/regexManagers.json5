{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  regexManagers: [
    {
      description: 'Cloudnative Postgres container',
      fileMatch: [
        'kubernetes/apps/databases/cloudnative-pg/clusters/postgres-cluster.yaml'
      ],
      matchStrings: [
        'imageName: (?<depName>.*?):(?<currentValue>.*)'
      ],
      datasourceTemplate: 'docker'
    },
    {
      description: 'Process Kubernetes versions',
      fileMatch: [
        'infrastructure/ansible/roles/k8s/defaults/main.yaml',
        'infrastructure/talos/talconfig.yaml'
      ],
      matchStrings: [
        'kubernetes_version: (?<currentValue>.*)',
        'kubernetesVersion: (?<currentValue>.*)',
      ],
      depNameTemplate: 'ghcr.io/siderolabs/kubelet',
      datasourceTemplate: 'docker'
    },
    {
      description: 'Process Talos versions',
      fileMatch: [
          'infrastructure/talos/common.sh',
          'infrastructure/talos/talconfig.yaml',
      ],
      matchStrings: [
        'talosVersion: (?<currentValue>.*)',
        'installer:(?<currentValue>.*)',
      ],
      depNameTemplate: 'ghcr.io/siderolabs/installer',
      datasourceTemplate: 'docker'
    },
    {
      description: 'Process CLI versions',
      fileMatch: [
          '.taskfiles/.+\\.yaml$'
      ],
      matchStrings: [
        'github.com\/(?<depName>.*?)\/releases\/download\/(?<currentValue>[a-z0-9.]*)',
      ],
      datasourceTemplate: 'github-releases'
    },
    {
      description: 'CNI integration',
      fileMatch: [
          'infrastructure/talos/integrations/cni/kustomization.yaml',
          'infrastructure/talos/integrations/kubelet-csr-approver/kustomization.yaml',
      ],
      matchStrings: [
        'version: (?<currentValue>.*)\n    releaseName: (?<depName>.*)\n',
      ],
      datasourceTemplate: 'flux',
    },
  ],
}
